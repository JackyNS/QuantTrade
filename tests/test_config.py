{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "098e2a27",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "ğŸš€ é‡åŒ–äº¤æ˜“æ¡†æ¶Configæ¨¡å—æµ‹è¯•\n",
      "==================================================\n",
      "ğŸ“ å½“å‰å·¥ä½œç›®å½•: /Users/jackstudio/æ ‡å‡†é‡åŒ–æ¡†æ¶æ­å»º/config\n",
      "ğŸ Pythonç‰ˆæœ¬: 3.13.5\n",
      "â° æµ‹è¯•å¼€å§‹æ—¶é—´: 2025-08-23 14:58:49\n",
      "\n",
      "ğŸ“¦ æ£€æŸ¥å¿…è¦çš„PythonåŒ…...\n",
      "âœ… pandas å·²å®‰è£…\n",
      "âœ… numpy å·²å®‰è£…\n",
      "âœ… æ‰€æœ‰ä¾èµ–åŒ…åŠ è½½æˆåŠŸ\n",
      "\n",
      "ğŸ” è®¾ç½®é¡¹ç›®è·¯å¾„å’Œå¯¼å…¥é…ç½®æ¨¡å—\n",
      "==================================================\n",
      "ğŸ“ æ‰¾åˆ°é¡¹ç›®æ ¹ç›®å½•: /Users/jackstudio/æ ‡å‡†é‡åŒ–æ¡†æ¶æ­å»º\n",
      "\n",
      "ğŸ” æµ‹è¯•1: é…ç½®æ¨¡å—å¯¼å…¥æµ‹è¯•\n",
      "==================================================\n",
      "âœ… é…ç½®åŠ è½½æˆåŠŸ\n",
      "âœ… æ•°æ®ç›®å½•åˆå§‹åŒ–å®Œæˆ\n",
      "âœ… æ•°æ®åº“é…ç½®åŠ è½½æˆåŠŸ\n",
      "ğŸ“‹ é…ç½®æ¨¡å—åŠ è½½å®Œæˆ v1.0.0\n",
      "âœ… settings.Config å¯¼å…¥æˆåŠŸ\n",
      "âœ… trading_config.TradingConfig å¯¼å…¥æˆåŠŸ\n",
      "âœ… database_config.DatabaseConfig å¯¼å…¥æˆåŠŸ\n",
      "âœ… æ‰€æœ‰é…ç½®å®ä¾‹åˆ›å»ºæˆåŠŸ\n",
      "\n",
      "ğŸ“‹ é…ç½®æ‘˜è¦:\n",
      "\n",
      "Config Summary:\n",
      "===============\n",
      "ğŸ“… æ—¶é—´èŒƒå›´: 2020-01-01 â†’ 2024-08-20\n",
      "ğŸ’° åˆå§‹èµ„é‡‘: Â¥1,000,000\n",
      "ğŸ¯ è‚¡ç¥¨æ± : CSI300 (Top-30)\n",
      "ğŸ“ˆ ç­–ç•¥ç±»å‹: ML\n",
      "ğŸ”„ è°ƒä»“é¢‘ç‡: W\n",
      "ğŸŒ è¿è¡Œç¯å¢ƒ: development\n",
      "===============\n",
      "\n",
      "\n",
      "ğŸ” æµ‹è¯•2: åŸºç¡€é…ç½®åŠŸèƒ½æµ‹è¯•\n",
      "==================================================\n",
      "ğŸ“… æ—¶é—´é…ç½®æµ‹è¯•:\n",
      "  å¼€å§‹æ—¥æœŸ: 2020-01-01\n",
      "  ç»“æŸæ—¥æœŸ: 2024-08-20\n",
      "  å›æµ‹å¼€å§‹: 2021-01-01\n",
      "\n",
      "ğŸ’° èµ„é‡‘é…ç½®æµ‹è¯•:\n",
      "  åˆå§‹èµ„é‡‘: Â¥1,000,000\n",
      "  æœ€å¤§å•è‚¡ä»“ä½: 5.0%\n",
      "  ç°é‡‘ç¼“å†²: 5.0%\n",
      "\n",
      "ğŸ¯ ç­–ç•¥é…ç½®æµ‹è¯•:\n",
      "  è‚¡ç¥¨æ± : CSI300\n",
      "  é€‰è‚¡æ•°é‡: 30\n",
      "  è°ƒä»“é¢‘ç‡: W\n",
      "  æ¨¡å‹ç±»å‹: LGBModel\n",
      "\n",
      "ğŸ”§ é…ç½®æ–¹æ³•æµ‹è¯•:\n",
      "  æ—¥æœŸèŒƒå›´: ('2020-01-01', '2024-08-20')\n",
      "  å›æµ‹èŒƒå›´: ('2021-01-01', '2024-08-20')\n",
      "  ç”Ÿäº§ç¯å¢ƒ: False\n",
      "  ç¼“å­˜è·¯å¾„: ./cache/test.csv\n",
      "  é…ç½®éªŒè¯: âœ… é€šè¿‡\n",
      "\n",
      "ğŸ” æµ‹è¯•3: äº¤æ˜“é…ç½®æµ‹è¯•\n",
      "==================================================\n",
      "ğŸ’¸ äº¤æ˜“æˆæœ¬æµ‹è¯•:\n",
      "  ä¹°å…¥æˆæœ¬ç‡: 0.0023 (0.232%)\n",
      "  å–å‡ºæˆæœ¬ç‡: 0.0033 (0.332%)\n",
      "\n",
      "â° äº¤æ˜“æ—¶é—´æµ‹è¯•:\n",
      "  09:30:00 (å¼€ç›˜): âœ…\n",
      "  10:30:00 (æ—©ç›˜): âœ…\n",
      "  12:00:00 (åˆä¼‘): âŒ\n",
      "  14:00:00 (åˆç›˜): âœ…\n",
      "  16:00:00 (æ”¶ç›˜å): âŒ\n",
      "\n",
      "ğŸ¯ ä»“ä½è®¡ç®—æµ‹è¯•:\n",
      "  100ä¸‡èµ„é‡‘ï¼Œ5%æƒé‡ï¼Œ50å…ƒè‚¡ä»· â†’ 900è‚¡\n",
      "\n",
      "ğŸ“‹ è®¢å•éªŒè¯æµ‹è¯•:\n",
      "  æ­£å¸¸è®¢å•: âœ… (è®¢å•éªŒè¯é€šè¿‡)\n",
      "  éæ•´ç™¾è‚¡: âŒ (è‚¡æ•°å¿…é¡»ä¸º100çš„æ•´æ•°å€)\n",
      "\n",
      "ğŸ” æµ‹è¯•4: æ•°æ®åº“é…ç½®æµ‹è¯•\n",
      "==================================================\n",
      "ğŸ—„ï¸ æ•°æ®åº“é…ç½®æµ‹è¯•:\n",
      "  æ•°æ®åº“ç±»å‹: sqlite\n",
      "  ç¼“å­˜ç±»å‹: memory\n",
      "  æ•°æ®åº“URL: sqlite:///./data/quant_trading.db\n",
      "\n",
      "ğŸš€ ç¼“å­˜é…ç½®æµ‹è¯•:\n",
      "  ç¼“å­˜ç±»å‹: memory\n",
      "\n",
      "ğŸŒ APIé…ç½®æµ‹è¯•:\n",
      "  ä¼˜çŸ¿APIé…ç½®: 5 ä¸ªå‚æ•°\n",
      "\n",
      "ğŸ“ ç›®å½•ç®¡ç†æµ‹è¯•:\n",
      "âœ… æ•°æ®ç›®å½•åˆå§‹åŒ–å®Œæˆ\n",
      "  âœ… ç›®å½•åˆ›å»ºå®Œæˆ\n",
      "\n",
      "ğŸ” æµ‹è¯•5: ç¯å¢ƒå˜é‡è¦†ç›–æµ‹è¯•\n",
      "==================================================\n",
      "åŸå§‹é…ç½® - èµ„é‡‘: Â¥1,000,000, Top-K: 30\n",
      "è¦†ç›–é…ç½® - èµ„é‡‘: Â¥2,000,000, Top-K: 50\n",
      "èµ„é‡‘è¦†ç›–: âœ… æˆåŠŸ\n",
      "Top-Kè¦†ç›–: âœ… æˆåŠŸ\n",
      "\n",
      "ğŸ¯ æµ‹è¯•æ€»ç»“æŠ¥å‘Š\n",
      "==================================================\n",
      "ğŸ“Š æµ‹è¯•ç»Ÿè®¡:\n",
      "  æ€»æµ‹è¯•é¡¹ç›®: 5\n",
      "  é€šè¿‡é¡¹ç›®: 5\n",
      "  å¤±è´¥é¡¹ç›®: 0\n",
      "  é€šè¿‡ç‡: 100.0%\n",
      "\n",
      "ğŸ“‹ è¯¦ç»†æµ‹è¯•ç»“æœ:\n",
      "  é…ç½®æ¨¡å—å¯¼å…¥: âœ… é€šè¿‡\n",
      "  åŸºç¡€é…ç½®åŠŸèƒ½: âœ… é€šè¿‡\n",
      "  äº¤æ˜“é…ç½®: âœ… é€šè¿‡\n",
      "  æ•°æ®åº“é…ç½®: âœ… é€šè¿‡\n",
      "  ç¯å¢ƒå˜é‡è¦†ç›–: âœ… é€šè¿‡\n",
      "\n",
      "ğŸ¯ æ€»ä½“è¯„ä¼°: ğŸ‰ ä¼˜ç§€\n",
      "ğŸ’¡ å»ºè®®: é…ç½®æ¨¡å—è¿è¡Œå®Œç¾ï¼Œå¯ä»¥æŠ•å…¥ä½¿ç”¨ï¼\n",
      "\n",
      "ğŸ“‹ åç»­å¼€å‘å»ºè®®\n",
      "==============================\n",
      "âœ… Configæ¨¡å—åŸºæœ¬å°±ç»ªï¼Œå¯ä»¥å¼€å§‹ä¸‹ä¸€æ­¥:\n",
      "  1. ğŸ“Š å¼€å‘dataæ¨¡å— - æ•°æ®è·å–å’Œå¤„ç†\n",
      "  2. ğŸ§  å¼€å‘strategyæ¨¡å— - ç­–ç•¥å®ç°\n",
      "  3. âš¡å¼€å‘backtestæ¨¡å— - å›æµ‹å¼•æ“\n",
      "  4. ğŸ“ˆ å¼€å‘visualizationæ¨¡å— - å¯è§†åŒ–\n",
      "\n",
      "ğŸ’¡ å¼€å‘ç¯å¢ƒä¼˜åŒ–å»ºè®®:\n",
      "  ğŸ”¹ åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ: python -m venv quant_env\n",
      "  ğŸ”¹ å®‰è£…å¼€å‘ä¾èµ–: pip install -r requirements.txt\n",
      "  ğŸ”¹ é…ç½®IDE: è®¾ç½®Pythonè§£é‡Šå™¨å’Œå·¥ä½œç›®å½•\n",
      "  ğŸ”¹ ç‰ˆæœ¬æ§åˆ¶: åˆå§‹åŒ–gitä»“åº“å¹¶æäº¤ä»£ç \n",
      "\n",
      "==================================================\n",
      "ğŸŠ Configæ¨¡å—æµ‹è¯•å®Œæˆï¼\n",
      "â° æµ‹è¯•ç»“æŸæ—¶é—´: 2025-08-23 14:58:49\n",
      "==================================================\n"
     ]
    },
    {
     "ename": "SystemExit",
     "evalue": "0",
     "output_type": "error",
     "traceback": [
      "An exception has occurred, use %tb to see the full traceback.\n",
      "\u001b[0;31mSystemExit\u001b[0m\u001b[0;31m:\u001b[0m 0\n"
     ]
    }
   ],
   "source": [
    "\"\"\"\n",
    "Configæ¨¡å—å®Œæ•´æµ‹è¯•å’ŒéªŒè¯ - ä¿®å¤ç‰ˆ\n",
    "===============================\n",
    "\n",
    "è¿™ä¸ªnotebookç”¨äºå…¨é¢æµ‹è¯•é‡åŒ–äº¤æ˜“æ¡†æ¶çš„é…ç½®æ¨¡å—ï¼Œç¡®ä¿æ‰€æœ‰é…ç½®éƒ½èƒ½æ­£å¸¸å·¥ä½œã€‚\n",
    "\n",
    "ä¿®å¤å†…å®¹ï¼š\n",
    "1. âœ… ä¿®å¤å˜é‡ä½œç”¨åŸŸé—®é¢˜\n",
    "2. âœ… æ­£ç¡®çš„ä»£ç æ‰§è¡Œé¡ºåº\n",
    "3. âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†\n",
    "4. âœ… æ¸…æ™°çš„æµ‹è¯•æŠ¥å‘Š\n",
    "\"\"\"\n",
    "\n",
    "import os\n",
    "import sys\n",
    "import subprocess\n",
    "import warnings\n",
    "from datetime import datetime, timedelta, time\n",
    "\n",
    "# ç¦ç”¨è­¦å‘Š\n",
    "warnings.filterwarnings('ignore')\n",
    "\n",
    "def main():\n",
    "    \"\"\"ä¸»æµ‹è¯•å‡½æ•°\"\"\"\n",
    "    print(\"ğŸš€ é‡åŒ–äº¤æ˜“æ¡†æ¶Configæ¨¡å—æµ‹è¯•\")\n",
    "    print(\"=\" * 50)\n",
    "    print(f\"ğŸ“ å½“å‰å·¥ä½œç›®å½•: {os.getcwd()}\")\n",
    "    print(f\"ğŸ Pythonç‰ˆæœ¬: {sys.version.split()[0]}\")\n",
    "    print(f\"â° æµ‹è¯•å¼€å§‹æ—¶é—´: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\")\n",
    "\n",
    "    # è®°å½•æµ‹è¯•ç»“æœ\n",
    "    test_results = {}\n",
    "    \n",
    "    # ========================================\n",
    "    # æ­¥éª¤1: ç¯å¢ƒæ£€æŸ¥å’Œä¾èµ–å®‰è£…\n",
    "    # ========================================\n",
    "    print(f\"\\nğŸ“¦ æ£€æŸ¥å¿…è¦çš„PythonåŒ…...\")\n",
    "    \n",
    "    required_packages = {\n",
    "        'pandas': 'pandas',\n",
    "        'numpy': 'numpy'\n",
    "    }\n",
    "\n",
    "    missing_packages = []\n",
    "    for package_display, package_install in required_packages.items():\n",
    "        try:\n",
    "            __import__(package_display)\n",
    "            print(f\"âœ… {package_display} å·²å®‰è£…\")\n",
    "        except ImportError:\n",
    "            print(f\"âŒ {package_display} æœªå®‰è£…\")\n",
    "            missing_packages.append(package_install)\n",
    "\n",
    "    if missing_packages:\n",
    "        print(f\"\\nâš ï¸ å‘ç°ç¼ºå¤±åŒ…: {', '.join(missing_packages)}\")\n",
    "        try:\n",
    "            for package in missing_packages:\n",
    "                subprocess.check_call([\n",
    "                    sys.executable, \"-m\", \"pip\", \"install\", package, \"--quiet\"\n",
    "                ])\n",
    "                print(f\"âœ… {package} å®‰è£…æˆåŠŸ\")\n",
    "        except subprocess.CalledProcessError as e:\n",
    "            print(f\"âŒ åŒ…å®‰è£…å¤±è´¥: {e}\")\n",
    "            print(\"ğŸ’¡ è¯·æ‰‹åŠ¨è¿è¡Œ: pip install pandas numpy\")\n",
    "            return False\n",
    "\n",
    "    # å¯¼å…¥å¿…è¦åŒ…\n",
    "    try:\n",
    "        import pandas as pd\n",
    "        import numpy as np\n",
    "        print(\"âœ… æ‰€æœ‰ä¾èµ–åŒ…åŠ è½½æˆåŠŸ\")\n",
    "    except ImportError as e:\n",
    "        print(f\"âŒ åŒ…å¯¼å…¥å¤±è´¥: {e}\")\n",
    "        return False\n",
    "\n",
    "    # ========================================\n",
    "    # æ­¥éª¤2: é¡¹ç›®è·¯å¾„è®¾ç½®\n",
    "    # ========================================\n",
    "    print(\"\\nğŸ” è®¾ç½®é¡¹ç›®è·¯å¾„å’Œå¯¼å…¥é…ç½®æ¨¡å—\")\n",
    "    print(\"=\" * 50)\n",
    "\n",
    "    current_dir = os.getcwd()\n",
    "    project_root = None\n",
    "\n",
    "    # æŸ¥æ‰¾åŒ…å«configç›®å½•çš„çˆ¶ç›®å½•\n",
    "    search_dirs = [current_dir, os.path.dirname(current_dir)]\n",
    "    for search_dir in search_dirs:\n",
    "        config_path = os.path.join(search_dir, 'config')\n",
    "        if os.path.exists(config_path) and os.path.isdir(config_path):\n",
    "            project_root = search_dir\n",
    "            break\n",
    "\n",
    "    if project_root:\n",
    "        print(f\"ğŸ“ æ‰¾åˆ°é¡¹ç›®æ ¹ç›®å½•: {project_root}\")\n",
    "        if project_root not in sys.path:\n",
    "            sys.path.insert(0, project_root)\n",
    "    else:\n",
    "        print(\"âš ï¸ æœªæ‰¾åˆ°configç›®å½•ï¼Œä½¿ç”¨å½“å‰ç›®å½•\")\n",
    "        if current_dir not in sys.path:\n",
    "            sys.path.insert(0, current_dir)\n",
    "\n",
    "    # ========================================\n",
    "    # æµ‹è¯•1: é…ç½®æ¨¡å—å¯¼å…¥æµ‹è¯•\n",
    "    # ========================================\n",
    "    print(\"\\nğŸ” æµ‹è¯•1: é…ç½®æ¨¡å—å¯¼å…¥æµ‹è¯•\")\n",
    "    print(\"=\" * 50)\n",
    "\n",
    "    try:\n",
    "        from config.settings import Config\n",
    "        print(\"âœ… settings.Config å¯¼å…¥æˆåŠŸ\")\n",
    "        \n",
    "        from config.trading_config import TradingConfig\n",
    "        print(\"âœ… trading_config.TradingConfig å¯¼å…¥æˆåŠŸ\")\n",
    "        \n",
    "        from config.database_config import DatabaseConfig\n",
    "        print(\"âœ… database_config.DatabaseConfig å¯¼å…¥æˆåŠŸ\")\n",
    "\n",
    "        # æµ‹è¯•å®ä¾‹åˆ›å»º\n",
    "        config = Config()\n",
    "        trading_config = TradingConfig()\n",
    "        database_config = DatabaseConfig()\n",
    "        print(\"âœ… æ‰€æœ‰é…ç½®å®ä¾‹åˆ›å»ºæˆåŠŸ\")\n",
    "\n",
    "        # æ˜¾ç¤ºé…ç½®æ‘˜è¦\n",
    "        print(\"\\nğŸ“‹ é…ç½®æ‘˜è¦:\")\n",
    "        print(config)\n",
    "        \n",
    "        test_results['import_test'] = True\n",
    "        \n",
    "    except ImportError as e:\n",
    "        print(f\"âŒ å¯¼å…¥å¤±è´¥: {e}\")\n",
    "        print(\"ğŸ’¡ è¯·æ£€æŸ¥configç›®å½•ç»“æ„\")\n",
    "        test_results['import_test'] = False\n",
    "    except Exception as e:\n",
    "        print(f\"âŒ æœªçŸ¥é”™è¯¯: {e}\")\n",
    "        test_results['import_test'] = False\n",
    "\n",
    "    # ========================================\n",
    "    # æµ‹è¯•2: åŸºç¡€é…ç½®åŠŸèƒ½æµ‹è¯•\n",
    "    # ========================================\n",
    "    print(\"\\nğŸ” æµ‹è¯•2: åŸºç¡€é…ç½®åŠŸèƒ½æµ‹è¯•\")\n",
    "    print(\"=\" * 50)\n",
    "\n",
    "    if test_results.get('import_test', False):\n",
    "        try:\n",
    "            # æµ‹è¯•æ—¶é—´é…ç½®\n",
    "            print(\"ğŸ“… æ—¶é—´é…ç½®æµ‹è¯•:\")\n",
    "            print(f\"  å¼€å§‹æ—¥æœŸ: {config.START_DATE}\")\n",
    "            print(f\"  ç»“æŸæ—¥æœŸ: {config.END_DATE}\")\n",
    "            print(f\"  å›æµ‹å¼€å§‹: {config.BACKTEST_START}\")\n",
    "\n",
    "            # æµ‹è¯•èµ„é‡‘é…ç½®\n",
    "            print(\"\\nğŸ’° èµ„é‡‘é…ç½®æµ‹è¯•:\")\n",
    "            print(f\"  åˆå§‹èµ„é‡‘: Â¥{config.INITIAL_CAPITAL:,}\")\n",
    "            print(f\"  æœ€å¤§å•è‚¡ä»“ä½: {config.MAX_POSITION_SIZE:.1%}\")\n",
    "            print(f\"  ç°é‡‘ç¼“å†²: {config.CASH_BUFFER:.1%}\")\n",
    "\n",
    "            # æµ‹è¯•ç­–ç•¥é…ç½®\n",
    "            print(\"\\nğŸ¯ ç­–ç•¥é…ç½®æµ‹è¯•:\")\n",
    "            print(f\"  è‚¡ç¥¨æ± : {config.UNIVERSE}\")\n",
    "            print(f\"  é€‰è‚¡æ•°é‡: {config.TOP_K}\")\n",
    "            print(f\"  è°ƒä»“é¢‘ç‡: {config.REBALANCE_FREQ}\")\n",
    "            print(f\"  æ¨¡å‹ç±»å‹: {config.ML_MODEL}\")\n",
    "\n",
    "            # æµ‹è¯•é…ç½®æ–¹æ³•\n",
    "            print(\"\\nğŸ”§ é…ç½®æ–¹æ³•æµ‹è¯•:\")\n",
    "            date_range = config.get_date_range()\n",
    "            backtest_range = config.get_backtest_range()\n",
    "            is_prod = config.is_production()\n",
    "            cache_path = config.get_cache_path(\"test.csv\")\n",
    "\n",
    "            print(f\"  æ—¥æœŸèŒƒå›´: {date_range}\")\n",
    "            print(f\"  å›æµ‹èŒƒå›´: {backtest_range}\")\n",
    "            print(f\"  ç”Ÿäº§ç¯å¢ƒ: {is_prod}\")\n",
    "            print(f\"  ç¼“å­˜è·¯å¾„: {cache_path}\")\n",
    "\n",
    "            # æµ‹è¯•é…ç½®éªŒè¯\n",
    "            is_valid = config.validate_config()\n",
    "            print(f\"  é…ç½®éªŒè¯: {'âœ… é€šè¿‡' if is_valid else 'âŒ å¤±è´¥'}\")\n",
    "\n",
    "            test_results['config_functionality'] = is_valid\n",
    "\n",
    "        except Exception as e:\n",
    "            print(f\"âŒ é…ç½®æµ‹è¯•å¤±è´¥: {e}\")\n",
    "            test_results['config_functionality'] = False\n",
    "    else:\n",
    "        print(\"âŒ è·³è¿‡æµ‹è¯•2 - é…ç½®æ¨¡å—å¯¼å…¥å¤±è´¥\")\n",
    "        test_results['config_functionality'] = False\n",
    "\n",
    "    # ========================================\n",
    "    # æµ‹è¯•3: äº¤æ˜“é…ç½®æµ‹è¯•\n",
    "    # ========================================\n",
    "    print(\"\\nğŸ” æµ‹è¯•3: äº¤æ˜“é…ç½®æµ‹è¯•\")\n",
    "    print(\"=\" * 50)\n",
    "\n",
    "    if test_results.get('import_test', False):\n",
    "        try:\n",
    "            # æµ‹è¯•äº¤æ˜“æˆæœ¬è®¡ç®—\n",
    "            print(\"ğŸ’¸ äº¤æ˜“æˆæœ¬æµ‹è¯•:\")\n",
    "            buy_cost = trading_config.get_total_cost(is_buy=True)\n",
    "            sell_cost = trading_config.get_total_cost(is_buy=False)\n",
    "\n",
    "            print(f\"  ä¹°å…¥æˆæœ¬ç‡: {buy_cost:.4f} ({buy_cost*100:.3f}%)\")\n",
    "            print(f\"  å–å‡ºæˆæœ¬ç‡: {sell_cost:.4f} ({sell_cost*100:.3f}%)\")\n",
    "\n",
    "            # æµ‹è¯•äº¤æ˜“æ—¶é—´åˆ¤æ–­\n",
    "            print(\"\\nâ° äº¤æ˜“æ—¶é—´æµ‹è¯•:\")\n",
    "            test_times = [\n",
    "                (time(9, 30), \"å¼€ç›˜\"),\n",
    "                (time(10, 30), \"æ—©ç›˜\"),\n",
    "                (time(12, 0), \"åˆä¼‘\"),\n",
    "                (time(14, 0), \"åˆç›˜\"),\n",
    "                (time(16, 0), \"æ”¶ç›˜å\")\n",
    "            ]\n",
    "\n",
    "            for test_time, desc in test_times:\n",
    "                is_trading = trading_config.is_trading_time(test_time)\n",
    "                status = \"âœ…\" if is_trading else \"âŒ\"\n",
    "                print(f\"  {test_time} ({desc}): {status}\")\n",
    "\n",
    "            # æµ‹è¯•ä»“ä½è®¡ç®—\n",
    "            print(\"\\nğŸ¯ ä»“ä½è®¡ç®—æµ‹è¯•:\")\n",
    "            position = trading_config.calculate_position_size(1000000, 0.05, 50.0)\n",
    "            print(f\"  100ä¸‡èµ„é‡‘ï¼Œ5%æƒé‡ï¼Œ50å…ƒè‚¡ä»· â†’ {position}è‚¡\")\n",
    "\n",
    "            # æµ‹è¯•è®¢å•éªŒè¯\n",
    "            print(\"\\nğŸ“‹ è®¢å•éªŒè¯æµ‹è¯•:\")\n",
    "            valid, msg = trading_config.validate_order('market', 1000, 50.0, 100000)\n",
    "            print(f\"  æ­£å¸¸è®¢å•: {'âœ…' if valid else 'âŒ'} ({msg})\")\n",
    "\n",
    "            valid, msg = trading_config.validate_order('market', 150, 50.0, 100000)\n",
    "            print(f\"  éæ•´ç™¾è‚¡: {'âœ…' if valid else 'âŒ'} ({msg})\")\n",
    "\n",
    "            test_results['trading_config'] = True\n",
    "\n",
    "        except Exception as e:\n",
    "            print(f\"âŒ äº¤æ˜“é…ç½®æµ‹è¯•å¤±è´¥: {e}\")\n",
    "            test_results['trading_config'] = False\n",
    "    else:\n",
    "        print(\"âŒ è·³è¿‡æµ‹è¯•3 - é…ç½®æ¨¡å—å¯¼å…¥å¤±è´¥\")\n",
    "        test_results['trading_config'] = False\n",
    "\n",
    "    # ========================================\n",
    "    # æµ‹è¯•4: æ•°æ®åº“é…ç½®æµ‹è¯•\n",
    "    # ========================================\n",
    "    print(\"\\nğŸ” æµ‹è¯•4: æ•°æ®åº“é…ç½®æµ‹è¯•\")\n",
    "    print(\"=\" * 50)\n",
    "\n",
    "    if test_results.get('import_test', False):\n",
    "        try:\n",
    "            # æµ‹è¯•æ•°æ®åº“é…ç½®\n",
    "            print(\"ğŸ—„ï¸ æ•°æ®åº“é…ç½®æµ‹è¯•:\")\n",
    "            print(f\"  æ•°æ®åº“ç±»å‹: {database_config.DATABASE_TYPE}\")\n",
    "            print(f\"  ç¼“å­˜ç±»å‹: {database_config.CACHE_TYPE}\")\n",
    "\n",
    "            # æµ‹è¯•è¿æ¥å­—ç¬¦ä¸²ç”Ÿæˆ\n",
    "            db_url = database_config.get_database_url()\n",
    "            print(f\"  æ•°æ®åº“URL: {db_url}\")\n",
    "\n",
    "            # æµ‹è¯•ç¼“å­˜é…ç½®\n",
    "            print(\"\\nğŸš€ ç¼“å­˜é…ç½®æµ‹è¯•:\")\n",
    "            cache_config = database_config.get_cache_config()\n",
    "            print(f\"  ç¼“å­˜ç±»å‹: {cache_config.get('type')}\")\n",
    "\n",
    "            # æµ‹è¯•APIé…ç½®\n",
    "            print(\"\\nğŸŒ APIé…ç½®æµ‹è¯•:\")\n",
    "            uqer_config = database_config.get_api_config('uqer')\n",
    "            print(f\"  ä¼˜çŸ¿APIé…ç½®: {len(uqer_config)} ä¸ªå‚æ•°\")\n",
    "\n",
    "            # æµ‹è¯•ç›®å½•ç®¡ç†\n",
    "            print(\"\\nğŸ“ ç›®å½•ç®¡ç†æµ‹è¯•:\")\n",
    "            database_config.ensure_directories()\n",
    "            print(\"  âœ… ç›®å½•åˆ›å»ºå®Œæˆ\")\n",
    "\n",
    "            test_results['database_config'] = True\n",
    "\n",
    "        except Exception as e:\n",
    "            print(f\"âŒ æ•°æ®åº“é…ç½®æµ‹è¯•å¤±è´¥: {e}\")\n",
    "            test_results['database_config'] = False\n",
    "    else:\n",
    "        print(\"âŒ è·³è¿‡æµ‹è¯•4 - é…ç½®æ¨¡å—å¯¼å…¥å¤±è´¥\")\n",
    "        test_results['database_config'] = False\n",
    "\n",
    "    # ========================================\n",
    "    # æµ‹è¯•5: ç¯å¢ƒå˜é‡è¦†ç›–æµ‹è¯•\n",
    "    # ========================================\n",
    "    print(\"\\nğŸ” æµ‹è¯•5: ç¯å¢ƒå˜é‡è¦†ç›–æµ‹è¯•\")\n",
    "    print(\"=\" * 50)\n",
    "\n",
    "    if test_results.get('import_test', False):\n",
    "        try:\n",
    "            # ä¿å­˜åŸå§‹å€¼\n",
    "            original_capital = config.INITIAL_CAPITAL\n",
    "            original_top_k = config.TOP_K\n",
    "\n",
    "            print(f\"åŸå§‹é…ç½® - èµ„é‡‘: Â¥{original_capital:,}, Top-K: {original_top_k}\")\n",
    "\n",
    "            # è®¾ç½®ç¯å¢ƒå˜é‡\n",
    "            os.environ['QUANT_INITIAL_CAPITAL'] = '2000000'\n",
    "            os.environ['QUANT_TOP_K'] = '50'\n",
    "\n",
    "            # åˆ›å»ºæ–°é…ç½®\n",
    "            new_config = Config()\n",
    "            new_capital = new_config.INITIAL_CAPITAL\n",
    "            new_top_k = new_config.TOP_K\n",
    "\n",
    "            print(f\"è¦†ç›–é…ç½® - èµ„é‡‘: Â¥{new_capital:,}, Top-K: {new_top_k}\")\n",
    "\n",
    "            # æ£€æŸ¥æ˜¯å¦æˆåŠŸè¦†ç›–\n",
    "            capital_changed = new_capital != original_capital\n",
    "            top_k_changed = new_top_k != original_top_k\n",
    "\n",
    "            print(f\"èµ„é‡‘è¦†ç›–: {'âœ… æˆåŠŸ' if capital_changed else 'âŒ å¤±è´¥'}\")\n",
    "            print(f\"Top-Kè¦†ç›–: {'âœ… æˆåŠŸ' if top_k_changed else 'âŒ å¤±è´¥'}\")\n",
    "\n",
    "            # æ¸…ç†ç¯å¢ƒå˜é‡\n",
    "            if 'QUANT_INITIAL_CAPITAL' in os.environ:\n",
    "                del os.environ['QUANT_INITIAL_CAPITAL']\n",
    "            if 'QUANT_TOP_K' in os.environ:\n",
    "                del os.environ['QUANT_TOP_K']\n",
    "\n",
    "            test_results['env_override'] = capital_changed and top_k_changed\n",
    "\n",
    "        except Exception as e:\n",
    "            print(f\"âŒ ç¯å¢ƒå˜é‡æµ‹è¯•å¤±è´¥: {e}\")\n",
    "            test_results['env_override'] = False\n",
    "    else:\n",
    "        print(\"âŒ è·³è¿‡æµ‹è¯•5 - é…ç½®æ¨¡å—å¯¼å…¥å¤±è´¥\")\n",
    "        test_results['env_override'] = False\n",
    "\n",
    "    # ========================================\n",
    "    # æµ‹è¯•æ€»ç»“æŠ¥å‘Š\n",
    "    # ========================================\n",
    "    print(\"\\nğŸ¯ æµ‹è¯•æ€»ç»“æŠ¥å‘Š\")\n",
    "    print(\"=\" * 50)\n",
    "\n",
    "    # è®¡ç®—æ€»ä½“é€šè¿‡ç‡\n",
    "    total_tests = len(test_results)\n",
    "    passed_tests = sum(test_results.values())\n",
    "    pass_rate = (passed_tests / total_tests) * 100\n",
    "\n",
    "    print(f\"ğŸ“Š æµ‹è¯•ç»Ÿè®¡:\")\n",
    "    print(f\"  æ€»æµ‹è¯•é¡¹ç›®: {total_tests}\")\n",
    "    print(f\"  é€šè¿‡é¡¹ç›®: {passed_tests}\")\n",
    "    print(f\"  å¤±è´¥é¡¹ç›®: {total_tests - passed_tests}\")\n",
    "    print(f\"  é€šè¿‡ç‡: {pass_rate:.1f}%\")\n",
    "\n",
    "    print(f\"\\nğŸ“‹ è¯¦ç»†æµ‹è¯•ç»“æœ:\")\n",
    "    test_descriptions = {\n",
    "        'import_test': 'é…ç½®æ¨¡å—å¯¼å…¥',\n",
    "        'config_functionality': 'åŸºç¡€é…ç½®åŠŸèƒ½',\n",
    "        'trading_config': 'äº¤æ˜“é…ç½®',\n",
    "        'database_config': 'æ•°æ®åº“é…ç½®',\n",
    "        'env_override': 'ç¯å¢ƒå˜é‡è¦†ç›–'\n",
    "    }\n",
    "\n",
    "    for test_key, result in test_results.items():\n",
    "        desc = test_descriptions.get(test_key, test_key)\n",
    "        status = \"âœ… é€šè¿‡\" if result else \"âŒ å¤±è´¥\"\n",
    "        print(f\"  {desc}: {status}\")\n",
    "\n",
    "    # æ€»ä½“è¯„ä¼°å’Œå»ºè®®\n",
    "    if pass_rate >= 90:\n",
    "        overall_status = \"ğŸ‰ ä¼˜ç§€\"\n",
    "        recommendation = \"é…ç½®æ¨¡å—è¿è¡Œå®Œç¾ï¼Œå¯ä»¥æŠ•å…¥ä½¿ç”¨ï¼\"\n",
    "    elif pass_rate >= 75:\n",
    "        overall_status = \"âœ… è‰¯å¥½\"\n",
    "        recommendation = \"é…ç½®æ¨¡å—åŸºæœ¬æ­£å¸¸ï¼Œå»ºè®®ä¿®å¤å¤±è´¥çš„æµ‹è¯•é¡¹ã€‚\"\n",
    "    elif pass_rate >= 50:\n",
    "        overall_status = \"âš ï¸ éœ€è¦æ”¹è¿›\"\n",
    "        recommendation = \"é…ç½®æ¨¡å—å­˜åœ¨é—®é¢˜ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥å’Œä¿®å¤ã€‚\"\n",
    "    else:\n",
    "        overall_status = \"âŒ ä¸¥é‡é—®é¢˜\"\n",
    "        recommendation = \"é…ç½®æ¨¡å—å­˜åœ¨é‡å¤§é—®é¢˜ï¼Œéœ€è¦å…¨é¢æ£€æŸ¥ã€‚\"\n",
    "\n",
    "    print(f\"\\nğŸ¯ æ€»ä½“è¯„ä¼°: {overall_status}\")\n",
    "    print(f\"ğŸ’¡ å»ºè®®: {recommendation}\")\n",
    "\n",
    "    # ä¿®å¤å»ºè®®\n",
    "    if passed_tests < total_tests:\n",
    "        print(f\"\\nğŸ”§ ä¿®å¤å»ºè®®:\")\n",
    "        \n",
    "        if not test_results.get('import_test', True):\n",
    "            print(\"  ğŸ”¹ æ£€æŸ¥configç›®å½•ç»“æ„ï¼Œç¡®ä¿æ‰€æœ‰.pyæ–‡ä»¶å­˜åœ¨\")\n",
    "            print(\"  ğŸ”¹ æ£€æŸ¥__init__.pyæ–‡ä»¶çš„å¯¼å…¥è¯­å¥\")\n",
    "            print(\"  ğŸ”¹ éªŒè¯Pythonæ–‡ä»¶è¯­æ³•æ˜¯å¦æ­£ç¡®\")\n",
    "        \n",
    "        if not test_results.get('config_functionality', True):\n",
    "            print(\"  ğŸ”¹ æ£€æŸ¥settings.pyä¸­çš„Configç±»å®ç°\")\n",
    "            print(\"  ğŸ”¹ éªŒè¯é…ç½®å‚æ•°çš„ç±»å‹å’ŒèŒƒå›´\")\n",
    "        \n",
    "        if not test_results.get('trading_config', True):\n",
    "            print(\"  ğŸ”¹ æ£€æŸ¥trading_config.pyä¸­çš„æ–¹æ³•å®ç°\")\n",
    "            print(\"  ğŸ”¹ éªŒè¯äº¤æ˜“æ—¶é—´å’Œæˆæœ¬è®¡ç®—é€»è¾‘\")\n",
    "        \n",
    "        if not test_results.get('database_config', True):\n",
    "            print(\"  ğŸ”¹ æ£€æŸ¥database_config.pyçš„ç›®å½•å’ŒURLç”Ÿæˆé€»è¾‘\")\n",
    "            print(\"  ğŸ”¹ éªŒè¯æ–‡ä»¶æƒé™å’Œè·¯å¾„è®¾ç½®\")\n",
    "        \n",
    "        if not test_results.get('env_override', True):\n",
    "            print(\"  ğŸ”¹ æ£€æŸ¥ç¯å¢ƒå˜é‡è¯»å–å’Œç±»å‹è½¬æ¢é€»è¾‘\")\n",
    "            print(\"  ğŸ”¹ éªŒè¯_load_environment_overridesæ–¹æ³•\")\n",
    "\n",
    "    # ========================================\n",
    "    # åç»­æ­¥éª¤å»ºè®®\n",
    "    # ========================================\n",
    "    print(\"\\nğŸ“‹ åç»­å¼€å‘å»ºè®®\")\n",
    "    print(\"=\" * 30)\n",
    "\n",
    "    if pass_rate >= 75:\n",
    "        print(\"âœ… Configæ¨¡å—åŸºæœ¬å°±ç»ªï¼Œå¯ä»¥å¼€å§‹ä¸‹ä¸€æ­¥:\")\n",
    "        print(\"  1. ğŸ“Š å¼€å‘dataæ¨¡å— - æ•°æ®è·å–å’Œå¤„ç†\")\n",
    "        print(\"  2. ğŸ§  å¼€å‘strategyæ¨¡å— - ç­–ç•¥å®ç°\")\n",
    "        print(\"  3. âš¡å¼€å‘backtestæ¨¡å— - å›æµ‹å¼•æ“\")\n",
    "        print(\"  4. ğŸ“ˆ å¼€å‘visualizationæ¨¡å— - å¯è§†åŒ–\")\n",
    "    else:\n",
    "        print(\"âš ï¸ å»ºè®®å…ˆä¿®å¤Configæ¨¡å—é—®é¢˜:\")\n",
    "        print(\"  1. ğŸ”§ æ ¹æ®ä¸Šè¿°ä¿®å¤å»ºè®®å®Œå–„é…ç½®\")\n",
    "        print(\"  2. ğŸ§ª é‡æ–°è¿è¡Œæµ‹è¯•ç¡®ä¿é€šè¿‡\")\n",
    "        print(\"  3. âœ… Configæ¨¡å—ç¨³å®šåå†ç»§ç»­å¼€å‘\")\n",
    "\n",
    "    print(\"\\nğŸ’¡ å¼€å‘ç¯å¢ƒä¼˜åŒ–å»ºè®®:\")\n",
    "    print(\"  ğŸ”¹ åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ: python -m venv quant_env\")\n",
    "    print(\"  ğŸ”¹ å®‰è£…å¼€å‘ä¾èµ–: pip install -r requirements.txt\")\n",
    "    print(\"  ğŸ”¹ é…ç½®IDE: è®¾ç½®Pythonè§£é‡Šå™¨å’Œå·¥ä½œç›®å½•\")\n",
    "    print(\"  ğŸ”¹ ç‰ˆæœ¬æ§åˆ¶: åˆå§‹åŒ–gitä»“åº“å¹¶æäº¤ä»£ç \")\n",
    "\n",
    "    print(\"\\n\" + \"=\" * 50)\n",
    "    print(\"ğŸŠ Configæ¨¡å—æµ‹è¯•å®Œæˆï¼\")\n",
    "    print(f\"â° æµ‹è¯•ç»“æŸæ—¶é—´: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\")\n",
    "    print(\"=\" * 50)\n",
    "    \n",
    "    return pass_rate >= 75\n",
    "\n",
    "# å¦‚æœä½œä¸ºè„šæœ¬è¿è¡Œ\n",
    "if __name__ == \"__main__\":\n",
    "    success = main()\n",
    "    sys.exit(0 if success else 1)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "base",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.13.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
